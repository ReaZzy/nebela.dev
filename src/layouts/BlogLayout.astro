---
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import { formatDate } from "@/utils/format-date";
import RandomAsciiImage from "@/components/ascii/random-ascii-image";
import { ASCII_IMAGE_PATHS } from "@/components/ascii/constants/random-ascii-images.config";
import AttachCopyToCode from "@/components/blog/AttachCopyToCode.astro";
import AttachAnchors from "@/components/blog/AttachAnchors.astro";
import BackToAllPosts from "@/components/blog/BackToAllPosts.astro";
import { ME } from "@/constants/me";
import type { Frontmatter } from "@/utils/blog";

interface Props {
  frontmatter: Frontmatter;
}

const { frontmatter } = Astro.props;
---

<Layout title={`${frontmatter.title} | ${ME.name}`} description={frontmatter.description}>
  <div class="relative z-10 min-h-screen flex flex-col">
    <Header currentPage="blog" />

    <main class="w-full max-w-4xl mx-auto px-4 pb-8 flex-1" transition:name="main-content">
      <BackToAllPosts class="mb-4" />
      <article class="prose max-w-none">
        <header class="mb-8 not-prose">
          <h1 class="font-mono text-2xl md:text-3xl mb-2">{frontmatter.title}</h1>
          <time datetime={frontmatter.date.toISOString()} class="font-mono text-sm text-zinc-500 dark:text-zinc-400">
            {formatDate(frontmatter.date)}
          </time>
        </header>

        <slot />
      </article>
      <BackToAllPosts class="mt-8" />
    </main>

    <Footer />
  </div>
  <RandomAsciiImage client:idle images={ASCII_IMAGE_PATHS.blog} className="opacity-20" />
  <AttachCopyToCode />
  <AttachAnchors />
</Layout>
